            var dwarfs = new Dictionary<string, Dictionary<string, int>>();

            string command = Console.ReadLine();
            while (command != "Once upon a time")
            {
                string[] dwarfArgs = command.Split(" <:> ");
                string name = dwarfArgs[0];
                string hatColor = dwarfArgs[1];
                int physics = int.Parse(dwarfArgs[2]);

                if (dwarfs.ContainsKey(hatColor))
                {
                    if (dwarfs[hatColor].ContainsKey(name))
                    {
                        if (dwarfs[hatColor][name] < physics)
                        {
                            dwarfs[hatColor][name] = physics;
                        }
                    }
                    else
                    {
                        dwarfs[hatColor].Add(name, physics);
                    }
                }
                else
                {
                    dwarfs.Add(hatColor, new Dictionary<string, int>());
                    dwarfs[hatColor].Add(name, physics);
                }

                command = Console.ReadLine();
            }

            //var ord = dwarfs.Values.OrderByDescending(x => x.Values.Max()).ThenByDescending(x => x.Keys.Count());

            foreach (var dwarf in dwarfs.OrderByDescending(x => x.Value.Values.Max())
                .ThenByDescending(x => x.Value.Count(x => x.Value == x.Value)))
            {
                foreach (var dwarfArgs in dwarf.Value)
                {
                    Console.WriteLine($"({dwarf.Key}) {dwarfArgs.Key} <-> {dwarfArgs.Value}");
                }
            }
